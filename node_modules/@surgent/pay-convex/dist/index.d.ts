/**
 * Surpay Convex Integration
 *
 * Provides Convex actions that wrap the Surpay SDK with auth context support.
 *
 * @example
 * ```typescript
 * // convex/surpay.ts
 * import { Surpay } from "@surgent/pay-convex";
 *
 * const surpay = new Surpay({
 *   apiKey: process.env.SURGENT_API_KEY!,
 *   identify: async (ctx) => {
 *     const identity = await ctx.auth.getUserIdentity();
 *     if (!identity) return null;
 *     return {
 *       customerId: identity.subject,
 *       customerData: { name: identity.name, email: identity.email },
 *     };
 *   },
 * });
 *
 * export const {
 *   createCheckout,
 *   guestCheckout,
 *   check,
 *   listProducts,
 *   getCustomer,
 *   listCustomers,
 *   listSubscriptions,
 * } = surpay.api();
 * ```
 */
import { GenericActionCtx } from "convex/server";
import { ResponseCase } from "@surgent/pay";
export type IdentifierOpts = {
    customerId: string;
    customerData?: {
        name?: string;
        email?: string;
    };
};
export type SurpayConfig<Ctx extends GenericActionCtx<any> = GenericActionCtx<any>> = {
    apiKey: string;
    baseUrl?: string;
    /**
     * Response key case format.
     * - 'camel' (default): camelCase keys matching TypeScript types
     * - 'snake': snake_case keys (legacy)
     */
    responseCase?: ResponseCase;
    /**
     * Identify the current user from the action context.
     * Return null if unauthenticated (will fail for auth-required actions).
     *
     * @example
     * ```typescript
     * identify: async (ctx) => {
     *   const identity = await ctx.auth.getUserIdentity();
     *   if (!identity) return null;
     *   return {
     *     customerId: identity.subject,
     *     customerData: { name: identity.name, email: identity.email },
     *   };
     * }
     * ```
     */
    identify: (ctx: Ctx) => Promise<IdentifierOpts | null>;
};
type PlainError = {
    message: string;
    code?: string;
};
export declare class Surpay<Ctx extends GenericActionCtx<any> = GenericActionCtx<any>> {
    private client;
    private options;
    constructor(config: SurpayConfig<Ctx>);
    private getIdentifierOpts;
    private requireAuth;
    api(): {
        /**
         * Create a checkout session for the authenticated user.
         * Requires user to be signed in (uses identify() for customerId).
         */
        createCheckout: import("convex/server").RegisteredAction<"public", {
            productId?: string | undefined;
            productSlug?: string | undefined;
            successUrl?: string | undefined;
            priceId: string;
        }, Promise<{
            data: null;
            error: PlainError;
        } | {
            data: import("@surgent/pay").CreateCheckoutResponse;
            error: null;
        }>>;
        /**
         * Create a checkout session for a guest (anonymous) user.
         * Does NOT require authentication - customerId must be provided explicitly.
         * Use this for anonymous checkout flows.
         */
        guestCheckout: import("convex/server").RegisteredAction<"public", {
            productId?: string | undefined;
            productSlug?: string | undefined;
            successUrl?: string | undefined;
            customerEmail?: string | undefined;
            customerName?: string | undefined;
            priceId: string;
            customerId: string;
        }, Promise<{
            data: null;
            error: PlainError;
        } | {
            data: import("@surgent/pay").CreateCheckoutResponse;
            error: null;
        }>>;
        /**
         * Check if a user has access to a product.
         * Pass `customerId` explicitly for guest flows, or omit it to resolve from identity.
         */
        check: import("convex/server").RegisteredAction<"public", {
            productId?: string | undefined;
            productSlug?: string | undefined;
            customerId?: string | undefined;
        }, Promise<{
            data: null;
            error: PlainError;
        } | {
            data: import("@surgent/pay").CheckResponse;
            error: null;
        }>>;
        /**
         * List all products with their prices.
         * Does not require authentication.
         */
        listProducts: import("convex/server").RegisteredAction<"public", {}, Promise<{
            data: null;
            error: PlainError;
        } | {
            data: import("@surgent/pay").ProductWithPrices[];
            error: null;
        }>>;
        /**
         * Get a specific customer by ID.
         * Does not require the caller to be that customer.
         */
        getCustomer: import("convex/server").RegisteredAction<"public", {
            customerId: string;
        }, Promise<{
            data: null;
            error: PlainError;
        } | {
            data: import("@surgent/pay").CustomerWithDetails;
            error: null;
        }>>;
        /**
         * List all customers (admin operation).
         */
        listCustomers: import("convex/server").RegisteredAction<"public", {}, Promise<{
            data: null;
            error: PlainError;
        } | {
            data: import("@surgent/pay").Customer[];
            error: null;
        }>>;
        /**
         * List all subscriptions (admin operation).
         */
        listSubscriptions: import("convex/server").RegisteredAction<"public", {}, Promise<{
            data: null;
            error: PlainError;
        } | {
            data: import("@surgent/pay").Subscription[];
            error: null;
        }>>;
    };
}
export * from "./types.js";
export type { ResponseCase } from "@surgent/pay";
export type { Customer, CustomerWithDetails, Product, ProductPrice, ProductWithPrices, Subscription, SubscriptionStatus, CreateCheckoutResponse, CheckResponse, } from "@surgent/pay";
//# sourceMappingURL=index.d.ts.map